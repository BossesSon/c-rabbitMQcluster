# ============================================================================
# RabbitMQ Load Test Parameters
# ============================================================================
# Configure your load test by editing the values below.
# After making changes, run: ./load_test.sh validate && ./load_test.sh test

# ============================================================================
# Core Test Parameters
# ============================================================================

# Message size in bytes (e.g., 1024 = 1KB, 102400 = 100KB)
MESSAGE_SIZE_BYTES=102400

# Target message rate (messages per second)
# Examples: 1000 (light), 10000 (medium), 150000 (maximum)
MESSAGES_PER_SECOND=10000

# Test duration in seconds
# Examples: 10 (quick test), 60 (1 minute), 300 (5 minutes)
TEST_DURATION_SECONDS=60

# ============================================================================
# Producer Configuration
# ============================================================================

# Number of producer worker processes
# Recommendation: 4-8 for high throughput tests
PRODUCER_WORKERS=4

# Number of connections per producer worker
# Recommendation: 10-50 depending on target rate
PRODUCER_CONNECTIONS_PER_WORKER=10

# Number of channels per producer connection
# Recommendation: 5-10 for better parallelism
PRODUCER_CHANNELS_PER_CONNECTION=5

# Publisher confirm mode (true/false)
# Set to true for guaranteed delivery, false for maximum speed
PUBLISHER_CONFIRMS=true

# Batch size for publishing (messages per batch)
# Higher values = better throughput but higher latency
PRODUCER_BATCH_SIZE=100

# ============================================================================
# Consumer Configuration
# ============================================================================

# Number of consumer worker processes
# Recommendation: 2-4 (usually less than producers)
CONSUMER_WORKERS=2

# Number of connections per consumer worker
# Recommendation: 10-20
CONSUMER_CONNECTIONS_PER_WORKER=10

# Prefetch count (messages to fetch ahead)
# Higher values = better throughput, more memory usage
# Recommendation: 100-500 for high throughput
CONSUMER_PREFETCH_COUNT=200

# Batch acknowledgment size
# Acknowledge every N messages for better performance
# Recommendation: 10-100
CONSUMER_BATCH_ACK_SIZE=50

# Message processing delay in milliseconds (0 = no delay)
# Simulate real work being done per message
CONSUMER_PROCESSING_DELAY_MS=0

# ============================================================================
# Queue Configuration
# ============================================================================

# Queue name for load test
QUEUE_NAME=load_test_queue

# Queue type: quorum or classic
# Recommendation: quorum for HA, classic for max speed
QUEUE_TYPE=quorum

# Queue durability (true/false)
QUEUE_DURABLE=true

# Message delivery mode: 1 (non-persistent) or 2 (persistent)
# Persistent messages survive broker restart but slower
MESSAGE_DELIVERY_MODE=2

# ============================================================================
# RabbitMQ Connection Configuration
# ============================================================================

# Connection heartbeat interval in seconds
# Recommendation: 30-60 for stable networks
HEARTBEAT_INTERVAL=30

# Connection timeout in seconds
CONNECTION_TIMEOUT=10

# Channel max (0 = server default)
CHANNEL_MAX=2047

# Frame max size in bytes (0 = server default, 131072 = 128KB)
FRAME_MAX=131072

# ============================================================================
# Monitoring and Reporting
# ============================================================================

# Enable real-time statistics output (true/false)
ENABLE_STATS_OUTPUT=true

# Statistics reporting interval in seconds
STATS_INTERVAL=5

# Enable Prometheus metrics export (true/false)
ENABLE_PROMETHEUS_METRICS=true

# Prometheus metrics port
PROMETHEUS_METRICS_PORT=8000

# ============================================================================
# Advanced Tuning
# ============================================================================

# Load balancing across multiple AMQP ports
# Set to true if RabbitMQ configured with multiple listeners (5672-5675)
USE_MULTIPLE_PORTS=false

# Retry settings for connection failures
MAX_CONNECTION_RETRIES=5
RETRY_DELAY_SECONDS=2

# Graceful shutdown timeout in seconds
SHUTDOWN_TIMEOUT=30

# ============================================================================
# Notes
# ============================================================================
#
# Performance Guidelines:
#
# For QUICK TEST (sanity check):
#   MESSAGE_SIZE_BYTES=1024
#   MESSAGES_PER_SECOND=1000
#   TEST_DURATION_SECONDS=10
#   PRODUCER_WORKERS=1, CONSUMER_WORKERS=1
#
# For MEDIUM TEST (configuration validation):
#   MESSAGE_SIZE_BYTES=10240
#   MESSAGES_PER_SECOND=10000
#   TEST_DURATION_SECONDS=60
#   PRODUCER_WORKERS=2, CONSUMER_WORKERS=2
#
# For FULL LOAD TEST (maximum throughput):
#   MESSAGE_SIZE_BYTES=102400
#   MESSAGES_PER_SECOND=150000
#   TEST_DURATION_SECONDS=100
#   PRODUCER_WORKERS=8, CONSUMER_WORKERS=4
#
# Calculation:
#   Total messages = MESSAGES_PER_SECOND * TEST_DURATION_SECONDS
#   Total data = Total messages * MESSAGE_SIZE_BYTES / 1024^3 GB
#
#   Example with defaults:
#   Total messages = 10000 * 60 = 600,000 messages
#   Total data = 600000 * 102400 / 1073741824 = 57 GB
#
